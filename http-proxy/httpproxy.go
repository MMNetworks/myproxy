/*
Package httpproxy provides a customizable HTTP proxy;
supports HTTP, HTTPS through CONNECT. And also provides HTTPS connection
using "Man in the Middle" style attack.

It's easy to use. `httpproxy.Proxy` implements `Handler` interface of `net/http`
package to offer `http.ListenAndServe` function.
*/
package httpproxy

// ConnectAction specifies action of after the CONNECT.
type ConnectAction int

// Constants of ConnectAction type.
const (
	// ConnectNone specifies that proxy request is not CONNECT.
	// If it returned in OnConnect, proxy connection closes immediately.
	ConnectNone = ConnectAction(iota)

	// ConnectProxy specifies directly socket proxy after the CONNECT.
	ConnectProxy

	// ConnectMitm specifies proxy "Man in the Middle" style attack
	// after the CONNECT.
	ConnectMitm
)

// DefaultCaCert provides default CA certificate.
var DefaultCaCert = []byte(`-----BEGIN CERTIFICATE-----
MIIFpTCCA42gAwIBAgIUb6fepmCz219zwOe/+Zfey3cj+cgwDQYJKoZIhvcNAQEL
BQAwYjEWMBQGA1UEAwwNbXlwcm94eVJvb3RDQTELMAkGA1UEBhMCTk4xEjAQBgNV
BAgMCVNvbWVTdGF0ZTEVMBMGA1UEBwwMU29tZUxvY2F0aW9uMRAwDgYDVQQKDAdt
eXByb3h5MB4XDTI1MDIxMjE0MDYxMFoXDTMwMDIxMjE0MDYxMFowYjEWMBQGA1UE
AwwNbXlwcm94eVJvb3RDQTELMAkGA1UEBhMCTk4xEjAQBgNVBAgMCVNvbWVTdGF0
ZTEVMBMGA1UEBwwMU29tZUxvY2F0aW9uMRAwDgYDVQQKDAdteXByb3h5MIICIjAN
BgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAp70GQaB9AU52161Aycyh90DclGej
VLwMa01faa2eYZ08IKe/mPEX2YidRIhitvrt3oYiRpuVUC/nUiSlsubyR2xrxyp7
i3bbYmAhLLeP2PPhWAH5xGlxThmcIVRxhkxuqUI5oprPj1hy/moBD7ZeBFiMqfrp
vlbwrL56cfZtjn9NxzpInJ87moBjknNU32K9P6O8pcaxwaCaW2gCJKu+vU+6ssbi
cWT3Uw+eZTfYCZJZ1h9iG7LlIj0+ifSdOEgKNLh1gGFHtfg4tnh6KM4nA9ZZ8QV2
J6sje1HTVPhUCnxCKZKVPC6Ksw5iIXvFQRrttblJGfIvZ8LKhZytVeh7/GgAH+sx
JDdoxgg+ZycBSFk7ki997L7D7mN78TQHEV4bCZmWpYKwL91qbMFaV5c+REGfuoA4
7YY6X+SSWxvV/GOIoypakz2LpYxrjHiGlfa4TBCCQETBNZTxBjaqayOMfDtc9YZF
qeraLJHBX4Fcdp5CkMyvVWV9QcOuBZdrPNz1zbn04m7wyF9A7wRQvF1RF5Bl7UkM
nFLdUulpepZLEiEC/EklQKG7O/IWz526fS7H2qPkx0gy2cX+CTFA5AXo7lLT6J4B
y+oE1ubKTai18MfMdm65PGVIF0d274C647HYcAdkBzLwU7g3P/uuLIFi5ceLuh3O
qbHU238Dl0rCSOcCAwEAAaNTMFEwHQYDVR0OBBYEFKe01fjQ4VctkJUJDhc5DjSo
I1bMMB8GA1UdIwQYMBaAFKe01fjQ4VctkJUJDhc5DjSoI1bMMA8GA1UdEwEB/wQF
MAMBAf8wDQYJKoZIhvcNAQELBQADggIBAA5yiJFyk0zMNNf/Di9kU1qvDgC/G4I/
PDnuGF09tc6vbrc6zSsgT13uimP0eHHSZLit8Ee/4bwHQ1o4tvGOQkoY09leRwNt
moQgggH09ay+xKsdrq66j5fQuTAGrkDucgOVdyU/j7qOYBFSUBbad7HXJRUazT49
G5FB6MR2SPdKGmlRNiOEWFTVR007hfCgfIIPAcDXae7SNd8Sx2RQQeBeyXw2T0HW
UJwjxJ73VmBVLKyLG4TQbs9mf5VQgUCjmbb5yGvJdO17chJdMSs3tPz9p4ksVCnl
zVqGJVbNgXCXK5Toz+knWACC3cVSOYS8rZoNn3q76gWnFFcXFBt96b3j/wTfmVf4
CvrYH3VHGFYkjrSgjpqE2JsTbBetIWYN5OIIlBVhCK1EvBewsEQDl3al34MhTppM
IqcE/7rp17X6Yr4h71XwVpb2Mvk0weZSREYuIPt9XAQHfqrLYbRCBfVtuzqUDT6T
Snkt6n0CZSv8y+XtJtorSC7iQgkUkwetghHs6n1l//RWd9AKAEg4U+5qb1YTQuV6
7oL/fo3CD6bx9pSqikp1yp16WmBqFi2lM7H5ZKWepS3gtyRP06DJ3fmcyC2aSVBN
leiDZRwTq5hKAaGNZBcSFYqvqSEdhimlgiTdPr287gr3HT1Ohsla/dh0DLJGpNAV
e4QTN/MyztPs
-----END CERTIFICATE-----`)

// DefaultCaKey provides default CA key.
var DefaultCaKey = []byte(`-----BEGIN RSA PRIVATE KEY-----
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
-----END RSA PRIVATE KEY-----`)
